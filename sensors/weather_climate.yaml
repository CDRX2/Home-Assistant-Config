- sensor:
  - unit_of_measurement: '%'
    default_entity_id: sensor.sunlight_pct
    state: '{%- set elevation = state_attr(''sun.sun'',''elevation'') | float(default=0) %}
            {%- set cloud_coverage = states(''sensor.openweathermap_cloud_coverage'') | float(default=0) %}
            {%- set cloud_factor = (1 - (0.75 * ( cloud_coverage / 100) ** 3 )) %}
            {%- set min_elevation = -6 %} {%- set max_elevation = 90 %}
            {%- set adjusted_elevation = elevation - min_elevation %}
            {%- set adjusted_elevation = [adjusted_elevation,0] | max %}
            {%- set adjusted_elevation = [adjusted_elevation,max_elevation - min_elevation] | min %}
            {%- set adjusted_elevation = adjusted_elevation / (max_elevation - min_elevation) %}
            {%- set adjusted_elevation = adjusted_elevation %}
            {%- set adjusted_elevation = adjusted_elevation * 100 %}
            {%- set brightness = adjusted_elevation * cloud_factor %} {{ brightness | round }}'
    name: sunlight_pct


    ## Daylight brightness converted to opacity for CSS
- sensor:
  - default_entity_id: sensor.sunlight_opacity
    state: '{%- set sunpct = states(''sensor.sunlight_pct'') | float(default=0) %}
            {%- set opacity = sunpct / 100 | float(default=0) %} {{ opacity }}'
    name: sunlight_opacity

- sensor:
  - unit_of_measurement: '%'
    default_entity_id: sensor.openweathermap_humidity_round
    state: '{{ states(''sensor.openweathermap_humidity'') | round(1) }}'
    name: openweathermap_humidity_round

- sensor:
  - unit_of_measurement: °C
    default_entity_id: sensor.openweathermap_temperature_round
    state: '{{ states(''sensor.openweathermap_temperature'') | round(1) }}'
    name: openweathermap_temperature_round

- sensor:
  - unit_of_measurement: °C
    default_entity_id: sensor.master_bedroom_temperature_round
    state: '{{ states(''sensor.master_bedroom_temperature'') | round(1) }}'
    name: master_bedroom_temperature_round
