type: 'custom:mod-card'
card:
  type: 'custom:state-switch'
  entity: sensor.remote_select
  states:
    "off":
      type: 'custom:layout-card'
      layout_type: custom:grid-layout
      layout:
        grid-template-columns: 25% 25% 25% 25%
        grid-template-rows: auto
        grid-template-areas: |
          "plex share youtube ytkids"
          "radio music bt tv"
          "home home home home"
        grid-gap: 0px
      cards:
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Plex
            service: script.watch_plex
            picture: /local/ui/btns/plex_off.png
          view_layout:
            grid-area: plex
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Partage
            service: script.screen_share
            picture: /local/ui/btns/screenshare_off.png
          view_layout:
            grid-area: share
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube
            service: script.watch_youtube
            picture: /local/ui/btns/youtube_off.png
          view_layout:
            grid-area: youtube
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube Kids
            service: script.watch_youtube_kids
            picture: /local/ui/btns/youtube-kids_off.png
          view_layout:
            grid-area: ytkids
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Couleur 3
            service: script.couleur_3
            picture: /local/ui/btns/couleur3_off.png
          view_layout:
            grid-area: radio
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Musique
            service: script.music
            picture: /local/ui/btns/music_off.png
          view_layout:
            grid-area: music
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Bluetooth
            service: script.bluetooth
            picture: /local/ui/btns/bluetooth_off.png
          view_layout:
            grid-area: bt
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Blue TV
            service: script.watch_tv
            picture: /local/ui/btns/blue_off.png
          view_layout:
            grid-area: tv
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/return_home.png")  
            justify: left
          view_layout:
            grid-area: home
          state_display: >
            [[[ return 'Retour à la maison'; ]]]
          tap_action:
            action: navigate
            navigation_path: /lovelace-visual/lights
          styles:
            state:
            - font-size: 5vw
    'music':
      type: 'custom:layout-card'
      layout_type: custom:grid-layout
      layout:
        grid-template-columns: 25% 25% 25% 25%
        grid-template-rows: auto
        grid-template-areas: |
          "plex share youtube ytkids"
          "radio music bt tv"
          "power stereo surround mute"
          "play previous next stop"
          "voldown voldown volup volup"
          "vol vol vol vol"
          "title title title title"
          "home home home home"
        grid-gap: 0px    
      cards:
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Plex
            service: script.watch_plex
            picture: /local/ui/btns/plex_off.png
          view_layout:
            grid-area: plex
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Partage
            service: script.screen_share
            picture: /local/ui/btns/screenshare_off.png
          view_layout:
            grid-area: share
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube
            service: script.watch_youtube
            picture: /local/ui/btns/youtube_off.png
          view_layout:
            grid-area: youtube
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube Kids
            service: script.watch_youtube_kids
            picture: /local/ui/btns/youtube-kids_off.png
          view_layout:
            grid-area: ytkids
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Couleur 3
            service: media_player.select_source
            picture: /local/ui/btns/couleur3_off.png
          view_layout:
            grid-area: radio
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              source: INTERNET RADIO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Musique
            service: script.music_source
            picture: /local/ui/btns/music_on.png
          view_layout:
            grid-area: music
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Bluetooth
            service: media_player.select_source
            picture: /local/ui/btns/bluetooth_off.png 
          view_layout:
            grid-area: bt
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              source: BT AUDIO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Blue TV
            service: script.watch_tv
            picture: /local/ui/btns/blue_off.png
          view_layout:
            grid-area: tv
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.turn_off
            picture: /local/ui/btns/power.png 
          view_layout:
            grid-area: power
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'EXTENDED STEREO' ? '/local/ui/btns/stereo_on.png' : '/local/ui/btns/stereo_off.png'; ]]]"
          view_layout: 
            grid-area: stereo
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: EXTENDED STEREO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'AUTO SURROUND' ? '/local/ui/btns/surround_on.png' : '/local/ui/btns/surround_off.png'; ]]]"
          view_layout: 
            grid-area: surround
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: AUTO SURROUND
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: script.AVR_mute
            picture: "[[[ return states['sensor.pioneer_volume'].state == 'MUTE' ? '/local/ui/btns/mute_on.png' : '/local/ui/btns/mute_off.png' ]]]"
          view_layout:
            grid-area: mute
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.media_play_pause
            picture: "[[[ return states['media_player.bubble'].state == 'playing' ? '/local/ui/btns/pause.png' : '/local/ui/btns/play.png' ]]]"
          view_layout:
            grid-area: play
          tap_action:
            service_data:
              entity_id: media_player.bubble
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.media_previous_track
            picture: /local/ui/btns/previous.png 
          view_layout:
            grid-area: previous
          tap_action:
            service_data:
              entity_id: media_player.bubble
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.media_next_track
            picture: /local/ui/btns/next.png 
          view_layout:
            grid-area: next
          tap_action:
            service_data:
              entity_id: media_player.bubble
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.media_stop
            picture: /local/ui/btns/stop.png
          view_layout:
            grid-area: stop
          tap_action:
            service_data:
              entity_id: media_player.bubble
        - type: 'custom:button-card'
          template: media_volume
          variables:
            service: media_player.volume_down
            picture: /local/ui/btns/volume_down.png
            radius: 10vw 0 0 10vw
            left: 20%
          view_layout:
            grid-area: voldown
        - type: 'custom:button-card'
          template: media_volume
          variables:
            service: media_player.volume_up
            picture: /local/ui/btns/volume_up.png
            radius: 0 10vw 10vw 0
            left: 0%
          view_layout:
            grid-area: volup
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/volume.png")  
            justify: right
          view_layout:
            grid-area: vol
          state_display: >
            [[[ var volume = (states['sensor.pioneer_volume'].state + ' dB');
            return states['sensor.pioneer_volume'].state == 'MUTE' ? 'MUTE' : volume; ]]]     
        - type: picture-elements
          image: /local/ui/btns/background_horizontal.png
          elements:
            - type: 'custom:button-card'
              template: media_state_title
              entity: media_player.bubble
              state_display: >
                [[[
                  if (entity) {
                    let elt = this.shadowRoot,
                      await = setTimeout(marquee, 0),
                      artist = entity.attributes.media_artist,
                      title = entity.attributes.media_title,
                      output = artist === undefined && title !== undefined
                        ? title
                        : title === undefined && artist !== undefined
                          ? artist
                          : title !== undefined && artist !== undefined
                            ? `${artist} - ${title}`
                            : variables.translate_idle;
                    function marquee() {
                      let state = elt.getElementById("state"),
                        container = elt.getElementById("container");
                      if (state && container) {
                        state.innerHTML = output;
                        let ro = new ResizeObserver(entries => {
                          let spacer = "&nbsp;".repeat(3),
                            s = entries[0],
                            c = entries[1],
                            r = s && s.contentRect &&
                                c && c.contentRect &&
                                s.contentRect.width !== 0 &&
                                c.contentRect.width !== 0;
                          if (r && s.contentRect.width < c.contentRect.width) {
                            state.classList.remove("marquee");
                          }
                          else if (r && s.contentRect.width >= c.contentRect.width) {
                            state.innerHTML = `${output} ${spacer} ${output} ${spacer}&nbsp;`;
                            state.classList.add("marquee");
                          }
                        });
                        ro.observe(state);
                        ro.observe(container);
                      }
                    }
                    return output;
                  }
                  return variables.translate_unknown;
                ]]]
          card_mod:
            style: |
              ha-card {
                background: none;
                border-radius: 0px;
                box-shadow: none;
              }
              :host {
                --masonry-view-card-margin: 0px !important;
              }
          view_layout:
            grid-area: title  
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/return_home.png")  
            justify: left
          view_layout:
            grid-area: home
          state_display: >
            [[[ return 'Retour à la maison'; ]]]
          tap_action:
            action: navigate
            navigation_path: /lovelace-visual/lights
          styles:
            state:
            - font-size: 5vw
    'bluetooth':
      type: 'custom:layout-card'
      layout_type: custom:grid-layout
      layout:
        grid-template-columns: 25% 25% 25% 25%
        grid-template-rows: auto
        grid-template-areas: |
          "plex share youtube ytkids"
          "radio music bt tv"
          "power stereo surround mute"
          "play previous next stop"
          "voldown voldown volup volup"
          "vol vol vol vol"
          "home home home home"
        grid-gap: 0px    
      cards:
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Plex
            service: script.watch_plex
            picture: /local/ui/btns/plex_off.png
          view_layout:
            grid-area: plex
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Partage
            service: script.screen_share
            picture: /local/ui/btns/screenshare_off.png
          view_layout:
            grid-area: share
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube
            service: script.watch_youtube
            picture: /local/ui/btns/youtube_off.png
          view_layout:
            grid-area: youtube
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube Kids
            service: script.watch_youtube_kids
            picture: /local/ui/btns/youtube-kids_off.png
          view_layout:
            grid-area: ytkids
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Couleur 3
            service: media_player.select_source
            picture: /local/ui/btns/couleur3_off.png
          view_layout:
            grid-area: radio
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              source: INTERNET RADIO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Musique
            service: script.music_source
            picture: /local/ui/btns/music_off.png
          view_layout:
            grid-area: music
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Bluetooth
            service: media_player.select_source
            picture: /local/ui/btns/bluetooth_on.png
          view_layout:
            grid-area: bt
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              source: BT AUDIO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Blue TV
            service: script.watch_tv
            picture: /local/ui/btns/blue_off.png
          view_layout:
            grid-area: tv
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.turn_off
            picture: /local/ui/btns/power.png 
          view_layout:
            grid-area: power
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'EXTENDED STEREO' ? '/local/ui/btns/stereo_on.png' : '/local/ui/btns/stereo_off.png'; ]]]"
          view_layout:
            grid-area: stereo
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: EXTENDED STEREO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'AUTO SURROUND' ? '/local/ui/btns/surround_on.png' : '/local/ui/btns/surround_off.png'; ]]]"
          view_layout:
            grid-area: surround
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: AUTO SURROUND
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: script.AVR_mute
            picture: "[[[ return states['sensor.pioneer_volume'].state == 'MUTE' ? '/local/ui/btns/mute_on.png' : '/local/ui/btns/mute_off.png' ]]]"
          view_layout:
            grid-area: mute
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.media_play_pause
            picture: /local/ui/btns/play_pause.png
          view_layout:
            grid-area: play
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.media_previous_track
            picture: /local/ui/btns/previous.png 
          view_layout:
            grid-area: previous
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.media_next_track
            picture: /local/ui/btns/next.png 
          view_layout:
            grid-area: next
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.media_stop
            picture: /local/ui/btns/stop.png
          view_layout:
            grid-area: stop
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
        - type: 'custom:button-card'
          template: media_volume
          variables:
            service: media_player.volume_down
            picture: /local/ui/btns/volume_down.png
            radius: 10vw 0 0 10vw
            left: 20%
          view_layout:
            grid-area: voldown
        - type: 'custom:button-card'
          template: media_volume
          variables:
            service: media_player.volume_up
            picture: /local/ui/btns/volume_up.png
            radius: 0 10vw 10vw 0
            left: 0%
          view_layout:
            grid-area: volup
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/volume.png")  
            justify: right
          state_display: >
            [[[ var volume = (states['sensor.pioneer_volume'].state + ' dB');
            return states['sensor.pioneer_volume'].state == 'MUTE' ? 'MUTE' : volume; ]]]     
          view_layout:
            grid-area: vol
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/return_home.png")  
            justify: left
          view_layout:
            grid-area: home
          state_display: >
            [[[ return 'Retour à la maison'; ]]]
          tap_action:
            action: navigate
            navigation_path: /lovelace-visual/lights
          styles:
            state:
            - font-size: 5vw
    'radio':
      type: 'custom:layout-card'
      layout_type: custom:grid-layout
      layout:
        grid-template-columns: 25% 25% 25% 25%
        grid-template-rows: auto
        grid-template-areas: |
          "plex share youtube ytkids"
          "radio music bt tv"
          "power stereo surround mute"
          "voldown voldown volup volup"
          "vol vol vol vol"
          "title title title title"
          "home home home home"
        grid-gap: 0px     
      cards:
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Plex
            service: script.watch_plex
            picture: /local/ui/btns/plex_off.png
          view_layout:
            grid-area: plex
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Partage
            service: script.screen_share
            picture: /local/ui/btns/screenshare_off.png
          view_layout:
            grid-area: share
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube
            service: script.watch_youtube
            picture: /local/ui/btns/youtube_off.png
          view_layout:
            grid-area: youtube
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube Kids
            service: script.watch_youtube_kids
            picture: /local/ui/btns/youtube-kids_off.png
          view_layout:
            grid-area: ytkids
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Couleur 3
            service: media_player.select_source
            picture: /local/ui/btns/couleur3_on.png
          view_layout:
            grid-area: radio
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              source: INTERNET RADIO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Musique
            service: script.music_source
            picture: /local/ui/btns/music_off.png
          view_layout:
            grid-area: music
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Bluetooth
            service: media_player.select_source
            picture: /local/ui/btns/bluetooth_off.png 
          view_layout:
            grid-area: bt
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              source: BT AUDIO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Blue TV
            service: script.watch_tv
            picture: /local/ui/btns/blue_off.png
          view_layout:
            grid-area: tv
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.turn_off
            picture: /local/ui/btns/power.png
          view_layout: 
            grid-area: power
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'EXTENDED STEREO' ? '/local/ui/btns/stereo_on.png' : '/local/ui/btns/stereo_off.png'; ]]]"
          view_layout: 
            grid-area: stereo
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: EXTENDED STEREO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'AUTO SURROUND' ? '/local/ui/btns/surround_on.png' : '/local/ui/btns/surround_off.png'; ]]]"
          view_layout:
            grid-area: surround
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: AUTO SURROUND
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: script.AVR_mute
            picture: "[[[ return states['sensor.pioneer_volume'].state == 'MUTE' ? '/local/ui/btns/mute_on.png' : '/local/ui/btns/mute_off.png' ]]]"
          view_layout:
            grid-area: mute
        - type: 'custom:button-card'
          template: media_volume
          variables:
            service: media_player.volume_down
            picture: /local/ui/btns/volume_down.png
            radius: 10vw 0 0 10vw
            left: 20%
          view_layout:
            grid-area: voldown
        - type: 'custom:button-card'
          template: media_volume
          variables:
            service: media_player.volume_up
            picture: /local/ui/btns/volume_up.png
            radius: 0 10vw 10vw 0
            left: 0%
          view_layout:
            grid-area: volup
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/volume.png")  
            justify: right
          state_display: >
            [[[ var volume = (states['sensor.pioneer_volume'].state + ' dB');
            return states['sensor.pioneer_volume'].state == 'MUTE' ? 'MUTE' : volume; ]]]     
          view_layout:
            grid-area: vol
        - type: picture-elements
          image: /local/ui/btns/background_horizontal.png
          elements:
            - type: 'custom:button-card'
              template: media_state_title
              entity: media_player.pioneer_avr
              state_display: >
                [[[
                  if (entity) {
                    let elt = this.shadowRoot,
                      await = setTimeout(marquee, 0),
                      title = entity.attributes.media_title,
                      output = title !== undefined
                        ? title
                        : variables.translate_idle;
                    function marquee() {
                      let state = elt.getElementById("state"),
                        container = elt.getElementById("container");
                      if (state && container) {
                        state.innerHTML = output;
                        let ro = new ResizeObserver(entries => {
                          let spacer = "&nbsp;".repeat(3),
                            s = entries[0],
                            c = entries[1],
                            r = s && s.contentRect &&
                                c && c.contentRect &&
                                s.contentRect.width !== 0 &&
                                c.contentRect.width !== 0;
                          if (r && s.contentRect.width < c.contentRect.width) {
                            state.classList.remove("marquee");
                          }
                          else if (r && s.contentRect.width >= c.contentRect.width) {
                            state.innerHTML = `${output} ${spacer} ${output} ${spacer}&nbsp;`;
                            state.classList.add("marquee");
                          }
                        });
                        ro.observe(state);
                        ro.observe(container);
                      }
                    }
                    return output;
                  }
                  return variables.translate_unknown;
                ]]]
          card_mod:
            style: |
              ha-card {
                background: none;
                border-radius: 0px;
                box-shadow: none;
              }
              :host {
                --masonry-view-card-margin: 0px !important;
              }
          view_layout:
            grid-area: title
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/return_home.png")  
            justify: left
          view_layout:
            grid-area: home
          state_display: >
            [[[ return 'Retour à la maison'; ]]]
          tap_action:
            action: navigate
            navigation_path: /lovelace-visual/lights
          styles:
            state:
            - font-size: 5vw
    'tv':
      type: 'custom:layout-card'
      layout_type: custom:grid-layout
      layout:
        grid-template-columns: 25% 25% 25% 25%
        grid-template-rows: auto
        grid-template-areas: |
          "plex share youtube ytkids"
          "power stereo surround mute"
          "play up back volup"
          "left enter right volup"
          "record down . voldown"
          "guide menu options voldown"
          "skipback rew fwd skipfwd"
          "vol vol vol vol"
          "home home home home"
        grid-gap: 0px 
      cards:
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Plex
            service: media_player.select_source
            picture: /local/ui/btns/plex_off.png 
          view_layout:
            grid-area: plex
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              source: Plex
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Partage
            service: media_player.select_source
            picture: /local/ui/btns/screenshare_off.png
          view_layout:
            grid-area: share
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              source: Screen Share
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube
            service: media_player.select_source
            picture: /local/ui/btns/youtube_off.png
          view_layout:
            grid-area: youtube
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              source: YouTube
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube Kids
            service: media_player.select_source
            picture: /local/ui/btns/youtube-kids_off.png
          view_layout:
            grid-area: ytkids
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              source: YouTube Kids
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.turn_off
            picture: /local/ui/btns/power.png
          view_layout:
            grid-area: power
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'EXTENDED STEREO' ? '/local/ui/btns/stereo_on.png' : '/local/ui/btns/stereo_off.png'; ]]]"
          view_layout:  
            grid-area: stereo
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: EXTENDED STEREO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'AUTO SURROUND' ? '/local/ui/btns/surround_on.png' : '/local/ui/btns/surround_off.png'; ]]]"
          view_layout:  
            grid-area: surround
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: AUTO SURROUND
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: script.AVR_mute
            picture: "[[[ return states['sensor.pioneer_volume'].state == 'MUTE' ? '/local/ui/btns/mute_on.png' : '/local/ui/btns/mute_off.png'; ]]]"
          view_layout:  
            grid-area: mute
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/play_pause.png
          view_layout:
            grid-area: play
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Play/Pause
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/up.png
          view_layout:
            grid-area: up
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Up
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/back.png
          view_layout:
            grid-area: back
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Back
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/left.png
          view_layout:
            grid-area: left
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Left
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/ok.png
          view_layout:
            grid-area: enter
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Ok
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/right.png
          view_layout:
            grid-area: right
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Right
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/record.png
          view_layout:
            grid-area: record
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Rec
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/down.png
          view_layout:
            grid-area: down
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Down  
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Guide TV
            service: remote.send_command
            picture: /local/ui/btns/guide.png
          view_layout:
            grid-area: guide
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Tv guide
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Menu
            service: remote.send_command
            picture: /local/ui/btns/menu.png
          view_layout:
            grid-area: menu
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Menu
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Options
            service: remote.send_command
            picture: /local/ui/btns/option.png
          view_layout:
            grid-area: options
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Option
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/rew-10.png
          view_layout:
            grid-area: skipback
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: -10sec
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/rewind.png
          view_layout:
            grid-area: rew
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Rewind
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/forward.png
          view_layout:
            grid-area: fwd
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: Forward
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: remote.send_command
            picture: /local/ui/btns/fwd-30.png
          view_layout:
            grid-area: skipfwd
          tap_action:
            service_data:
              entity_id: remote.swisscom
              command: +30sec   
        - type: 'custom:button-card'
          template: media_volume_vertical
          variables:
            service: media_player.volume_up
            picture: /local/ui/btns/volume_up_vertical.png
            radius: 10vw 10vw 0 0
            top: 20%
          view_layout:
            grid-area: volup
        - type: 'custom:button-card'
          template: media_volume_vertical
          variables:
            service: media_player.volume_down
            picture: /local/ui/btns/volume_down_vertical.png
            radius: 0 0 10vw 10vw
            top: 0%
          view_layout:
            grid-area: voldown
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/volume.png")  
            justify: right
          state_display: >
            [[[ var volume = (states['sensor.pioneer_volume'].state + ' dB');
            return states['sensor.pioneer_volume'].state == 'MUTE' ? 'MUTE' : volume; ]]]     
          view_layout:
            grid-area: vol
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/return_home.png")  
            justify: left
          view_layout:
            grid-area: home
          state_display: >
            [[[ return 'Retour à la maison'; ]]]
          tap_action:
            action: navigate
            navigation_path: /lovelace-visual/lights
          styles:
            state:
            - font-size: 5vw
    'other':
      type: 'custom:layout-card'
      layout_type: custom:grid-layout
      layout:
        grid-template-columns: 25% 25% 25% 25%
        grid-template-rows: auto
        grid-template-areas: |
          "plex share youtube ytkids"
          "power . tv mute"
          "menu stereo surround volup"
          "play up back volup"
          "left enter right voldown"
          ". down . voldown"
          "vol vol vol vol"
          "title title title title"
          "home home home home"
        grid-gap: 0px 
      cards:
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Plex
            service: media_player.select_source
            picture: "[[[ return states['media_player.living_room_tv'].attributes['source'] == 'Plex' ? '/local/ui/btns/plex_on.png' : '/local/ui/btns/plex_off.png'; ]]]"
          view_layout:
            grid-area: plex
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              source: Plex
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: Partage
            service: media_player.select_source
            picture: "[[[ return states['media_player.living_room_tv'].attributes['source'] == 'Screen Share' ? '/local/ui/btns/screenshare_on.png' : '/local/ui/btns/screenshare_off.png'; ]]]"
          view_layout:  
            grid-area: share
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              source: Screen Share
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube
            service: media_player.select_source
            picture: "[[[ return states['media_player.living_room_tv'].attributes['source'] == 'YouTube' ? '/local/ui/btns/youtube_on.png' : '/local/ui/btns/youtube_off.png'; ]]]"
          view_layout:  
            grid-area: youtube
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              source: YouTube
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: YouTube Kids
            service: media_player.select_source
            picture: "[[[ return states['media_player.living_room_tv'].attributes['source'] == 'YouTube Kids' ? '/local/ui/btns/youtube-kids_on.png' : '/local/ui/btns/youtube-kids_off.png'; ]]]"
          view_layout:
            grid-area: ytkids
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              source: YouTube Kids
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.turn_off
            picture: /local/ui/btns/power.png
          view_layout:
            grid-area: power
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv 
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: script.to_swisscom
            picture: /local/ui/btns/blue_off.png
          view_layout:
            grid-area: tv
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: script.AVR_mute
            picture: "[[[ return states['sensor.pioneer_volume'].state == 'MUTE' ? '/local/ui/btns/mute_on.png' : '/local/ui/btns/mute_off.png' ]]]"
          view_layout:
            grid-area: mute
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: webostv.button
            picture: /local/ui/btns/menu.png
          view_layout:
            grid-area: menu
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              button: HOME
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'EXTENDED STEREO' ? '/local/ui/btns/stereo_on.png' : '/local/ui/btns/stereo_off.png'; ]]]"
          view_layout:
            grid-area: stereo
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: EXTENDED STEREO
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.select_sound_mode
            picture: "[[[ return states['media_player.pioneer_avr'].attributes['current_sound_mode'] == 'AUTO SURROUND' ? '/local/ui/btns/surround_on.png' : '/local/ui/btns/surround_off.png'; ]]]"
          view_layout:
            grid-area: surround        
          tap_action:
            service_data:
              entity_id: media_player.pioneer_avr
              sound_mode: AUTO SURROUND
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: media_player.media_play_pause
            picture: >
              [[[ var play = (states['media_player.plex_plex_for_lg_lg_oled77w7v_z'].state);
              return play == 'playing' ? '/local/ui/btns/pause.png' : play == 'paused' ? '/local/ui/btns/play.png' : '/local/ui/btns/play_pause.png'; ]]]
          view_layout:
            grid-area: play
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: webostv.button
            picture: /local/ui/btns/up.png
          view_layout:
            grid-area: up
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              button: UP
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: webostv.button
            picture: /local/ui/btns/back.png
          view_layout:
            grid-area: back
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              button: BACK
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: webostv.button
            picture: /local/ui/btns/left.png
          view_layout:
            grid-area: left
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              button: LEFT
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: webostv.button
            picture: /local/ui/btns/ok.png
          view_layout:
            grid-area: enter
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              button: ENTER
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: webostv.button
            picture: /local/ui/btns/right.png
          view_layout:
            grid-area: right
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              button: RIGHT
        - type: 'custom:button-card'
          template: media_service
          variables:
            name: ''
            service: webostv.button
            picture: /local/ui/btns/down.png
          view_layout:
            grid-area: down
          tap_action:
            service_data:
              entity_id: media_player.living_room_tv
              button: DOWN
        - type: 'custom:button-card'
          template: media_volume_vertical
          variables:
            service: media_player.volume_up
            picture: /local/ui/btns/volume_up_vertical.png
            radius: 10vw 10vw 0 0
            top: 20%
          view_layout:
            grid-area: volup
        - type: 'custom:button-card'
          template: media_volume_vertical
          variables:
            service: media_player.volume_down
            picture: /local/ui/btns/volume_down_vertical.png
            radius: 0 0 10vw 10vw
            top: 0%
          view_layout:
            grid-area: voldown
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/volume.png")  
            justify: right
          state_display: >
            [[[ var volume = (states['sensor.pioneer_volume'].state + ' dB');
            return states['sensor.pioneer_volume'].state == 'MUTE' ? 'MUTE' : volume; ]]]     
          view_layout:
            grid-area: vol
        - type: picture-elements
          image: /local/ui/btns/background_horizontal.png
          elements:
            - type: 'custom:button-card'
              template: media_state_title
              entity: media_player.plex_plex_for_lg_lg_oled77w7v_z
              state_display: >
                [[[
                  if (entity) {
                    let elt = this.shadowRoot,
                      await = setTimeout(marquee, 0),
                      series_title = entity.attributes.media_series_title,
                      series_season = ` - S` + entity.attributes.media_season,
                      series_episode = ` E` + entity.attributes.media_episode,
                      episode_title = ` - ` + entity.attributes.media_title,
                      tvshow = series_title + series_season + series_episode + episode_title,
                      movie = entity.attributes.media_title,
                      output = states['sensor.living_room_tv_source'].state == 'Plex' && entity.attributes.media_content_type == 'tvshow'
                        ? `${tvshow}`
                        : states['sensor.living_room_tv_source'].state == 'Plex' && entity.attributes.media_content_type == 'movie'
                          ? `${movie}`
                          : states['sensor.living_room_tv_source'].state == 'Plex' && entity.attributes.media_content_type != 'movie' && entity.attributes.media_content_type != 'tvshow'
                            ? `Plex`
                            : states['sensor.living_room_tv_source'].state == 'YouTube'
                              ? `YouTube`
                              : states['sensor.living_room_tv_source'].state == 'YouTube Kids'
                                ? `YouTube Kids`
                                : states['sensor.living_room_tv_source'].state == 'Screen Share'
                                  ? `Partage d'écran`
                                  : variables.translate_idle;
                    function marquee() {
                      let state = elt.getElementById("state"),
                        container = elt.getElementById("container");
                      if (state && container) {
                        state.innerHTML = output;
                        let ro = new ResizeObserver(entries => {
                          let spacer = "&nbsp;".repeat(3),
                            s = entries[0],
                            c = entries[1],
                            r = s && s.contentRect &&
                                c && c.contentRect &&
                                s.contentRect.width !== 0 &&
                                c.contentRect.width !== 0;
                          if (r && s.contentRect.width < c.contentRect.width) {
                            state.classList.remove("marquee");
                          }
                          else if (r && s.contentRect.width >= c.contentRect.width) {
                            state.innerHTML = `${output} ${spacer} ${output} ${spacer}&nbsp;`;
                            state.classList.add("marquee");
                          }
                        });
                        ro.observe(state);
                        ro.observe(container);
                      }
                    }
                    return output;
                  }
                  return variables.translate_unknown;
                ]]]
          card_mod:
            style: |
              ha-card {
                background: none;
                border-radius: 0px;
                box-shadow: none;
              }
              :host {
                --masonry-view-card-margin: 0px !important;
              }
          view_layout:
            grid-area: title
        - type: 'custom:button-card'
          template: media_state  
          variables:
            background: transparent url("/local/ui/btns/return_home.png")  
            justify: left
          view_layout:
            grid-area: home
          state_display: >
            [[[ return 'Retour à la maison'; ]]]
          tap_action:
            action: navigate
            navigation_path: /lovelace-visual/lights
          styles:
            state:
            - font-size: 5vw
card_mod:
  style: |
    :host {
      align-self: center;
    }
view_layout:
  grid-area: remote