!function(){"use strict";const t={default:{background:"#222",gaugeBackground:"radial-gradient(circle, #444, #222)",centerBackground:"radial-gradient(circle, #333, #111)",textColor:"white",secondaryTextColor:"#ddd"},light:{background:"#f0f0f0",gaugeBackground:"radial-gradient(circle, #e0e0e0, #d0d0d0)",centerBackground:"radial-gradient(circle, #f5f5f5, #e5e5e5)",textColor:"#333",secondaryTextColor:"#666"},dark:{background:"#111",gaugeBackground:"radial-gradient(circle, #333, #111)",centerBackground:"radial-gradient(circle, #222, #000)",textColor:"#eee",secondaryTextColor:"#bbb"}};function e(t){return t?t.split(".")[0]:null}function n(t,e,n=0,o=100){const a=e||[{color:"#4caf50",value:20},{color:"#ffeb3b",value:50},{color:"#f44336",value:100}];for(const e of a)if(t<=(e.value-n)/(o-n)*100)return e.color;return"#555"}function o(t,e,n,o){if(!o)return(t-e)/(n-e)*100/100*360;const a=e<=0&&n>=0?0:(e+n)/2,i=n-e,r=a-e,s=n-a;return t>=a?(s>0?(t-a)/s*100:0)/100*(s/i*360):360-(r>0?(a-t)/r*100:0)/100*(r/i*360)}function a(t){const e=t._hass.states[t.config.entity];if(!e)return;const n=parseFloat(e?.state||"0"),o=null!==t.previousState?t.previousState:n,a=t.config.min||0,s=t.config.max||100;if(t.config.smooth_transitions&&o!==n)!function(t,e,n,o,a){const i=t.ledsCount||t.config.leds_count||100,r=(t.config.animation_duration||800)/20,s=n-e;t.animationInterval&&clearInterval(t.animationInterval);let c=0;t.animationInterval=setInterval(()=>{c++;const n=(r=c/20)<.5?4*r*r*r:1-Math.pow(-2*r+2,3)/2;var r;const l=e+s*n;t._updateLeds&&t._updateLeds(l,i,o,a);const d=(l-o)/(a-o)*100;t._updateCenterShadow&&t._updateCenterShadow(d,l,o,a);const u=t.shadowRoot?.querySelector(".value");u&&(u.textContent=l.toFixed(t.config.decimals||0)),c>=20&&(clearInterval(t.animationInterval),t.animationInterval=null)},r)}(t,o,n,a,s);else{i(t,n,t.ledsCount||t.config.leds_count||100,a,s),r(t,(n-a)/(s-a)*100,n,a,s);const e=t.shadowRoot.querySelector(".value"),o=t.shadowRoot.querySelector(".unit");e&&(e.textContent=n.toFixed(t.config.decimals||0)),o&&(o.textContent=t.config.unit||"")}t.previousState=n,t._updateButtonsState&&t._updateButtonsState()}function i(t,e,o,a,i){const r=function(t,e,n,o,a){const i=(t-e)/(n-e)*100;if(!a)return{activeLeds:Math.round(i/100*o),direction:"unidirectional",normalizedValue:i};const r=e<=0&&n>=0?0:(e+n)/2,s=n-e,c=r-e,l=n-r,d=c/s;if(t>=r){const e=l>0?(t-r)/l*100:0,n=o*(l/s);return{activeLeds:Math.round(e/100*n),direction:"positive",normalizedValue:i}}{const e=c>0?(r-t)/c*100:0,n=o*d;return{activeLeds:Math.round(e/100*n),direction:"negative",normalizedValue:i}}}(e,a,i,o,t.config.bidirectional||!1),s=n(r.normalizedValue,t.config.severity,a,i);if(t.config.enable_shadow){const e=t.shadowRoot.getElementById("gauge-container");e&&(e.style.boxShadow=`0 0 30px 2px ${s}`)}for(let e=0;e<o;e++){const n=t.shadowRoot.getElementById(`led-${e}`);if(!n)continue;let a=!1;"unidirectional"===r.direction||"positive"===r.direction?a=e<r.activeLeds:"negative"===r.direction&&(a=0===e||e>o-r.activeLeds),a?(n.style.display="",n.style.background=`radial-gradient(circle, rgba(255, 255, 255, 0.8), ${s})`,n.style.boxShadow=`0 0 8px ${s}`,n.classList.add("active")):(t.config.hide_inactive_leds?n.style.display="none":(n.style.display="",n.style.background="#333",n.style.boxShadow="none"),n.classList.remove("active"))}}function r(t,e,o,a,i){if(!t.config.center_shadow)return;const r=n(e,t.config.severity,a,i),s=t.config.center_shadow_blur||30,c=t.config.center_shadow_spread||15,l=t.shadowRoot.getElementById("center-shadow");t.currentShadowColor=r,l&&(t.pulsationInterval||(l.style.boxShadow=`0 0 ${s}px ${c}px ${r}`)),t.config.center_shadow_pulse&&void 0!==o&&void 0!==a&&void 0!==i&&function(t,e,n,o){if(!t.config.center_shadow||!t.config.center_shadow_pulse)return;const a=void 0!==t.config.center_shadow_pulse_min?t.config.center_shadow_pulse_min:n,i=void 0!==t.config.center_shadow_pulse_max?t.config.center_shadow_pulse_max:o,r=e>=a&&e<=i;if(r&&!t.pulsationInterval){const e=t.config.center_shadow_pulse_duration||1e3,n=t.config.center_shadow_pulse_intensity,o=t.config.center_shadow_blur||30,a=t.config.center_shadow_spread||15;let i=Date.now();t.pulsationInterval=setInterval(()=>{const r=(Date.now()-i)%e/e,s=.5*Math.sin(r*Math.PI*2)+.5,c=n+(1-n)*s,l=n+(1-n)*s,d=o*c,u=a*c,g=t.shadowRoot?.getElementById("center-shadow");if(g&&t.currentShadowColor){const e=t.currentShadowColor.replace("rgb","rgba").replace(")",`, ${l})`);g.style.boxShadow=`0 0 ${d}px ${u}px ${e}`}},16)}else if(!r&&t.pulsationInterval&&(clearInterval(t.pulsationInterval),t.pulsationInterval=null,t._updateCenterShadow)){const a=(e-n)/(o-n)*100;t._updateCenterShadow(a)}}(t,o,a,i)}function s(t){if(!t._hass||!t.config.buttons||0===t.config.buttons.length)return;const n=t.shadowRoot.getElementById("gauge-container");n&&(t.config.buttons.forEach((o,a)=>{const i=o.entity;if(!i)return;if(!t._hass.states[i])return void console.warn(`Entity ${i} not found`);const r=`button-${a}`;let s=t.shadowRoot.getElementById(r);if(!s){const l=e(i),d=o.icon||{switch:"‚óè",light:"üí°",scene:"üé¨",script:"‚ñ∂",input_boolean:"‚óè",automation:"ü§ñ",fan:"üåÄ",cover:"ü™ü",climate:"üå°Ô∏è",lock:"üîí",vacuum:"ü§ñ"}[l]||"‚óè",u=o.position||"bottom-right",g=o.icon_size||t.config.button_icon_size;s=document.createElement("div"),s.id=r,s.className=`switch-button ${u}`,s.innerHTML=d,s.dataset.entity=i,s.dataset.index=a,o.icon_size&&s.style.setProperty("--icon-size",`${g}px`),s.addEventListener("click",n=>{n.stopPropagation(),function(t,n){if(!n||!t._hass)return;const o=t._hass.states[n];if(!o)return;const a=e(n),i=o.state;let r,s,l;switch(a){case"switch":case"light":case"input_boolean":case"fan":r=a,s="toggle",l={entity_id:n};break;case"automation":r="automation",s="toggle",l={entity_id:n};break;case"scene":r="scene",s="turn_on",l={entity_id:n};break;case"script":r="script",s="turn_on",l={entity_id:n};break;case"cover":r="cover",s="open"===i?"close_cover":"open_cover",l={entity_id:n};break;case"lock":r="lock",s="locked"===i?"unlock":"lock",l={entity_id:n};break;case"vacuum":r="vacuum",s="cleaning"===i?"stop":"start",l={entity_id:n};break;case"climate":r="climate",s="off"===i?"turn_on":"turn_off",l={entity_id:n};break;default:return void console.warn(`Entity type ${a} not supported for button control`)}t._hass.callService(r,s,l).then(()=>{setTimeout(()=>c(t),100)}).catch(t=>{console.error(`Error calling ${r}.${s}:`,t)})}(t,i)}),n.appendChild(s)}}),c(t))}function c(t){t._hass&&t.config.buttons&&0!==t.config.buttons.length&&t.config.buttons.forEach((e,n)=>{const o=e.entity,a=t.shadowRoot.getElementById(`button-${n}`);if(!a||!o)return;const i=t._hass.states[o];if(!i)return;const r=i.state,s=["on","open","unlocked","home","active"].includes(r);a.classList.remove("on","off"),a.classList.add(s?"on":"off");const c=i.attributes.friendly_name||o;a.title=`${c}: ${r.toUpperCase()}`})}class l extends HTMLElement{setConfig(e){this.config=function(t){if(!t.entity)throw new Error("Entit√© non d√©finie.");const e={...t,update_interval:t.update_interval||1e3,power_save_mode:t.power_save_mode||!1,power_save_threshold:t.power_save_threshold||10,debounce_updates:t.debounce_updates||!1,smooth_transitions:!1!==t.smooth_transitions,animation_duration:t.animation_duration||800,buttons:t.buttons||[],title_font_family:t.title_font_family||"inherit",title_font_size:t.title_font_size||"16px",title_font_weight:t.title_font_weight||"normal",title_font_color:t.title_font_color||null,value_font_family:t.value_font_family||"inherit",value_font_size:t.value_font_size||"32px",value_font_weight:t.value_font_weight||"bold",value_font_color:t.value_font_color||null,unit_font_size:t.unit_font_size||"16px",unit_font_weight:t.unit_font_weight||"normal",unit_font_color:t.unit_font_color||null,button_icon_size:t.button_icon_size||22,transparent_card_background:t.transparent_card_background||!1,transparent_gauge_background:t.transparent_gauge_background||!1,transparent_center_background:t.transparent_center_background||!1,hide_shadows:t.hide_shadows||!1,hide_inactive_leds:t.hide_inactive_leds||!1,dynamic_markers:t.dynamic_markers||[],bidirectional:t.bidirectional||!1,card_width:t.card_width||null,card_height:t.card_height||null,card_padding:t.card_padding||"16px",center_shadow_pulse:t.center_shadow_pulse||!1,center_shadow_pulse_duration:t.center_shadow_pulse_duration||1e3,center_shadow_pulse_min:void 0!==t.center_shadow_pulse_min?t.center_shadow_pulse_min:t.min||0,center_shadow_pulse_max:void 0!==t.center_shadow_pulse_max?t.center_shadow_pulse_max:t.max||100,center_shadow_pulse_intensity:void 0!==t.center_shadow_pulse_intensity?t.center_shadow_pulse_intensity:.5};return t.show_switch_button&&t.switch_entity&&0===e.buttons.length&&(e.buttons=[{entity:t.switch_entity,position:t.switch_button_position||"bottom-right",icon:null}]),e}(e),this.previousState=null,this.updateTimer=null,this.isVisible=!0,this.animationInterval=null,this.pulsationInterval=null,this.buttonsInitialized=!1,this.attachShadow({mode:"open"}),function(e){e.ledsCount=e.config.leds_count||100;const n=e.ledsCount,o=function(e,n){let o;return o="custom"===e?{background:n.custom_background||"#222",gaugeBackground:n.custom_gauge_background||"radial-gradient(circle, #444, #222)",centerBackground:n.custom_center_background||"radial-gradient(circle, #333, #111)",textColor:n.custom_text_color||"white",secondaryTextColor:n.custom_secondary_text_color||"#ddd"}:{...t[e]||t.default},n.transparent_card_background&&(o.background="transparent"),n.transparent_gauge_background&&(o.gaugeBackground="transparent"),n.transparent_center_background&&(o.centerBackground="transparent"),o}(e.config.theme||"default",e.config),a=e.config.gauge_size||200,i=e.config.led_size||8,r=function(t,e){const n=e.led_size||8,o=e.center_size||120,a=e.gauge_size||200,i=e.hide_shadows;return`\n    --card-background: ${t.background};\n    --gauge-background: ${t.gaugeBackground};\n    --center-background: ${t.centerBackground};\n    --text-color: ${t.textColor};\n    --secondary-text-color: ${t.secondaryTextColor};\n    --gauge-size: ${a}px;\n    --center-size: ${o}px;\n    --led-size: ${n}px;\n    --card-width: ${e.card_width||"auto"};\n    --card-height: ${e.card_height||"auto"};\n    --card-padding: ${e.card_padding};\n    --card-shadow: ${i?"none":"0 0 15px rgba(0, 0, 0, 0.5)"};\n    --led-shadow: ${i?"none":"0 0 4px rgba(0, 0, 0, 0.8)"};\n    --button-shadow: ${i?"none":"0 2px 8px rgba(0, 0, 0, 0.3)"};\n    --button-hover-shadow: ${i?"none":"0 4px 12px rgba(0, 0, 0, 0.5)"};\n    --value-font-size: ${e.value_font_size};\n    --value-font-family: ${e.value_font_family};\n    --value-font-weight: ${e.value_font_weight};\n    --value-font-color: ${e.value_font_color||t.textColor};\n    --unit-font-size: ${e.unit_font_size};\n    --unit-font-weight: ${e.unit_font_weight};\n    --unit-font-color: ${e.unit_font_color||t.secondaryTextColor};\n    --title-font-size: ${e.title_font_size};\n    --title-font-family: ${e.title_font_family};\n    --title-font-weight: ${e.title_font_weight};\n    --title-font-color: ${e.title_font_color||t.textColor};\n    --button-icon-size: ${e.button_icon_size}px;\n  `}(o,e.config),s=`\n    <style>\n      :host {\n        ${r}\n      }\n      .gauge-card{background:var(--card-background);border-radius:15px;box-shadow:var(--card-shadow);cursor:pointer;flex-direction:column;font-family:var(--ha-card-header-font-family,Arial),sans-serif;height:var(--card-height);padding:var(--card-padding);transition:box-shadow .3s ease-in-out;width:var(--card-width)}.gauge,.gauge-card{align-items:center;display:flex;justify-content:center;position:relative}.gauge{background:var(--gauge-background);border-radius:50%;height:var(--gauge-size);width:var(--gauge-size)}.center-shadow{background:radial-gradient(circle,transparent,transparent);box-shadow:none;height:var(--center-size);transition:box-shadow .3s ease-in-out;width:var(--center-size)}.center-shadow,.led{border-radius:50%;position:absolute}.led{background:#333;box-shadow:var(--led-shadow);height:var(--led-size);transition:background .2s ease,box-shadow .2s ease;width:var(--led-size)}.led.active{box-shadow:0 0 8px currentColor,inset 0 0 3px currentColor}.center{align-items:center;background:var(--center-background);border-radius:50%;color:var(--text-color);display:flex;flex-direction:column;height:var(--center-size);justify-content:center;position:absolute;text-align:center;text-shadow:0 1px 3px rgba(0,0,0,.5);width:var(--center-size)}.value{color:var(--value-font-color);font-family:var(--value-font-family);font-size:var(--value-font-size);font-weight:var(--value-font-weight);transition:all .3s ease}.unit{color:var(--unit-font-color);font-size:var(--unit-font-size);font-weight:var(--unit-font-weight)}.title{color:var(--title-font-color);font-family:var(--title-font-family);font-size:var(--title-font-size);font-weight:var(--title-font-weight);margin-top:10px;text-shadow:0 1px 3px rgba(0,0,0,.5)}.trend-indicator{align-items:center;background:rgba(0,0,0,.6);border-radius:12px;bottom:10px;color:#fff;display:flex;font-size:12px;gap:5px;padding:4px 8px;position:absolute;right:10px;z-index:5}.trend-arrow{font-size:14px;font-weight:700}.marker{background:#fff;border-radius:2px;box-shadow:0 0 5px rgba(0,0,0,.5);height:12px;width:4px}.marker,.marker-label{position:absolute;z-index:2}.marker-label{color:#fff;font-size:10px;text-shadow:0 0 3px rgba(0,0,0,.7)}.dynamic-marker-container{align-items:center;display:flex;justify-content:center;pointer-events:none;position:absolute;z-index:3}.dynamic-marker{border:2px solid hsla(0,0%,100%,.8);box-shadow:0 0 8px rgba(0,0,0,.6),0 0 12px currentColor;position:relative;transition:background .3s ease-in-out,box-shadow .3s ease-in-out;z-index:3}.dynamic-marker-label{border-radius:4px;font-size:11px;font-weight:600;padding:2px 6px}.dynamic-marker-label,.dynamic-marker-value{background:rgba(0,0,0,.7);box-shadow:0 2px 4px rgba(0,0,0,.3);color:#fff;left:15px;position:absolute;text-shadow:0 1px 2px rgba(0,0,0,.8);white-space:nowrap;z-index:4}.dynamic-marker-value{border-radius:3px;font-size:10px;font-weight:500;padding:1px 5px;top:18px}.switch-button{align-items:center;border:2px solid hsla(0,0%,100%,.2);border-radius:50%;box-shadow:var(--button-shadow);cursor:pointer;display:flex;font-family:system-ui,-apple-system,Segoe UI,Segoe UI Emoji,Apple Color Emoji,sans-serif;font-size:var(--icon-size,var(--button-icon-size));font-weight:400;height:0;justify-content:center;line-height:1;position:absolute;transition:all .3s ease;width:0;z-index:3}.switch-button:hover{box-shadow:var(--button-hover-shadow);transform:scale(1.1)}.switch-button:active{transform:scale(.95)}.switch-button.on{background:linear-gradient(135deg,#4caf50,#2e7d32);color:#fff;filter:brightness(1.2);opacity:1;text-shadow:0 0 10px #4caf50,0 0 20px rgba(76,175,80,.6)}.switch-button.off{background:linear-gradient(135deg,#666,#333);color:#333;filter:grayscale(.5);opacity:.4;text-shadow:none}.switch-button.top-left{left:30px;top:30px}.switch-button.top-right{right:30px;top:30px}.switch-button.bottom-left{bottom:40px;left:30px}.switch-button.bottom-right{bottom:40px;right:30px}\n    </style>\n    <div class="gauge-card" id="gauge-container">\n      <div class="gauge">\n        <div class="center-shadow" id="center-shadow"></div>\n        ${Array.from({length:n}).map((t,e)=>`<div class="led" id="led-${e}" style="transform: rotate(${e/n*360-90}deg) translate(${a/2-i}px);"></div>`).join("")}\n        <div class="center">\n          <div class="value">0</div>\n          <div class="unit"></div>\n        </div>\n      </div>\n      <div class="title">${e.config.name||""}</div>\n    </div>\n  `;e.shadowRoot.innerHTML=s}(this),this._updateGauge=a.bind(null,this),this._updateLeds=i.bind(null,this),this._updateCenterShadow=r.bind(null,this),this._updateButtonsState=c.bind(null,this),this._createButtons=s.bind(null,this),this.shadowRoot.getElementById("gauge-container").addEventListener("click",()=>function(t){if(!t.config.entity||!t._hass)return;const e=new Event("hass-more-info",{bubbles:!0,composed:!0});e.detail={entityId:t.config.entity},t.dispatchEvent(e)}(this));const n=this.config.min||0,l=this.config.max||100;this._updateLeds(n,this.ledsCount,n,l),function(t){const e=t.shadowRoot.querySelector(".gauge-card"),n=t.config.entity,o=t.config.name||n;e.setAttribute("role","slider"),e.setAttribute("aria-valuemin",t.config.min||0),e.setAttribute("aria-valuemax",t.config.max||100),e.setAttribute("aria-label",`${o} gauge`);const a=n=>{e.setAttribute("aria-valuenow",n),e.setAttribute("aria-valuetext",`${n}${t.config.unit?" "+t.config.unit:""}`)},i=t.shadowRoot.querySelector(".value");i&&(new MutationObserver(()=>{a(parseFloat(i.textContent))}).observe(i,{childList:!0}),a(parseFloat(i.textContent||"0")))}(this),async function(t){if(!t.config.show_trend||!t._hass||!t.config.entity)return;const e=t.config.entity,n=new Date,o=new Date;o.setHours(n.getHours()-24);try{const a=await t._hass.callWS({type:"history/history_during_period",entity_ids:[e],start_time:o.toISOString(),end_time:n.toISOString(),minimal_response:!0});if(!a||!a[0]||0===a[0].length)return;const i=a[0],r=parseFloat(i[i.length-1].state),s=parseFloat(i[0].state),c=r-s,l=0!==s?c/s*100:0,d=document.createElement("div");d.className="trend-indicator";const u=document.createElement("span");u.className="trend-arrow";const g=document.createElement("span");g.className="trend-value",c>0?(u.textContent="‚Üë",u.style.color="#4caf50"):c<0?(u.textContent="‚Üì",u.style.color="#f44336"):(u.textContent="‚Üí",u.style.color="#ffeb3b"),g.textContent=`${Math.abs(l).toFixed(1)}%`,d.appendChild(u),d.appendChild(g),t.shadowRoot.querySelector(".gauge-card").appendChild(d)}catch(t){console.error("Erreur lors de la r√©cup√©ration de l'historique:",t)}}(this),function(t){if(!t.config.markers&&!t.config.zones)return;const e=t.shadowRoot.querySelector(".gauge");if(!e)return;const n=t.config.min||0,a=t.config.max||100,i=t.config.gauge_size||200;t.config.markers&&t.config.markers.forEach(r=>{const s=o(r.value,n,a,t.config.bidirectional),c=document.createElement("div");if(c.className="marker",c.style.cssText=`\n        position: absolute;\n        width: 4px;\n        height: 12px;\n        background: ${r.color||"#fff"};\n        border-radius: 2px;\n        transform: rotate(${s-90}deg) translateX(${i/2-5}px);\n        transform-origin: center center;\n        z-index: 2;\n        box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);\n      `,r.label){const t=document.createElement("div");t.className="marker-label",t.textContent=r.label,t.style.cssText=`\n          position: absolute;\n          font-size: 10px;\n          color: ${r.color||"#fff"};\n          transform: rotate(${s-90}deg) translateX(${i/2+15}px) rotate(${90-s}deg);\n          transform-origin: center center;\n          z-index: 2;\n          text-shadow: 0 0 3px rgba(0, 0, 0, 0.7);\n        `,e.appendChild(t)}e.appendChild(c)}),t.config.zones&&t.config.zones.forEach(r=>{const s=o(r.from,n,a,t.config.bidirectional),c=o(r.to,n,a,t.config.bidirectional);let l=c-s;l<0&&(l+=360);const d="http://www.w3.org/2000/svg",u=document.createElementNS(d,"svg");u.setAttribute("width",`${i+20}`),u.setAttribute("height",`${i+20}`),u.style.cssText="\n        position: absolute;\n        top: -10px;\n        left: -10px;\n        z-index: 1;\n        pointer-events: none;\n      ";const g=document.createElementNS(d,"path"),h=i/2+5,f=(i+20)/2,_=`M ${f+h*Math.cos((s-90)*Math.PI/180)},${f+h*Math.sin((s-90)*Math.PI/180)} A ${h},${h} 0 ${l>180?1:0},1 ${f+h*Math.cos((c-90)*Math.PI/180)},${f+h*Math.sin((c-90)*Math.PI/180)}`;g.setAttribute("d",_),g.setAttribute("fill","none"),g.setAttribute("stroke",r.color||"#fff"),g.setAttribute("stroke-width","4"),g.setAttribute("opacity",r.opacity||"0.5"),u.appendChild(g),e.appendChild(u)})}(this),function(t){if(!t.config.dynamic_markers||!Array.isArray(t.config.dynamic_markers))return;const e=t.shadowRoot.querySelector(".gauge");if(!e)return void console.warn("Gauge element not found, cannot create dynamic markers");t._dynamicMarkerElements&&t._dynamicMarkerElements.forEach(t=>t.remove()),t._dynamicMarkerElements=[],t._dynamicMarkerData=new Map;const n=t.config.gauge_size||200;t.config.dynamic_markers.forEach((o,a)=>{if(!o.entity)return void console.warn("Dynamic marker configuration missing entity",o);const i=document.createElement("div");i.className="dynamic-marker-container",i.dataset.entity=o.entity,i.dataset.index=a;const r=document.createElement("div");r.className="dynamic-marker";const s=o.size||8,c=o.color||"#4CAF50";if(r.style.cssText=`\n      width: ${s}px;\n      height: ${s}px;\n      background: ${c};\n      border-radius: 50%;\n    `,i.appendChild(r),o.label){const t=document.createElement("div");t.className="dynamic-marker-label",t.textContent=o.label,i.appendChild(t)}if(o.show_value){const t=document.createElement("div");t.className="dynamic-marker-value",t.textContent="-",i.appendChild(t)}i.style.cssText=`\n      position: absolute;\n      transform: rotate(-90deg) translateX(${n/2-10}px);\n      transform-origin: center center;\n      transition: transform 0.3s ease-in-out;\n    `,e.appendChild(i),t._dynamicMarkerElements.push(i),t._dynamicMarkerData.set(o.entity,{config:o,element:i,currentAngle:-90,targetAngle:-90})})}(this),function(t){if(!t.config.power_save_mode)return;const e={root:null,rootMargin:"0px",threshold:t.config.power_save_threshold/100};t.intersectionObserver=new IntersectionObserver(e=>{e.forEach(e=>{t.isVisible=e.isIntersecting,t.isVisible&&t._hass&&t._updateGauge&&t._updateGauge()})},e),t.intersectionObserver.observe(t)}(this)}set hass(t){this._hass=t,!this.buttonsInitialized&&this.shadowRoot&&(this._createButtons(),this.buttonsInitialized=!0),this.config.power_save_mode&&!this.isVisible||(function(t,e){if(!t._dynamicMarkerElements||0===t._dynamicMarkerElements.length)return;const n=t.config.min||0,o=t.config.max||100,a=o-n,i=t.config.gauge_size||200,r=t.config.animation_duration||1e3;t._dynamicMarkerData.forEach((s,c)=>{const l=e.states[c];if(!l)return console.warn(`Dynamic marker entity not found: ${c}`),void(s.element.style.opacity="0");s.element.style.opacity="1";let d,u=parseFloat(l.state);if(isNaN(u))return void console.warn(`Dynamic marker entity has non-numeric state: ${c} = ${l.state}`);if(u=Math.max(n,Math.min(o,u)),t.config.bidirectional){const t=n<=0&&o>=0?0:(n+o)/2,e=o-n,a=t-n,i=o-t;d=u>=t?(i>0?(u-t)/i*100:0)/100*(i/e*360)-90:360-(a>0?(t-u)/a*100:0)/100*(a/e*360)-90}else d=(u-n)/a*100/100*360-90;const g=s.element,h=g.querySelector(".dynamic-marker"),f=!1!==t.config.smooth_transitions?r/1e3:0;if(g.style.transition=`transform ${f}s ease-in-out`,g.style.transform=`rotate(${d}deg) translateX(${i/2-10}px)`,!s.config.color||"auto"===s.config.color){const t=function(t){return{sensor:"#2196F3",input_number:"#4CAF50",climate:"#FF9800",light:"#FFC107",switch:"#9C27B0",binary_sensor:"#00BCD4"}[t.entity_id.split(".")[0]]||"#4CAF50"}(l);h.style.background=t}if(s.config.show_value){const t=g.querySelector(".dynamic-marker-value");if(t){const e=l.attributes.unit_of_measurement||"";t.textContent=`${u.toFixed(1)}${e}`}}const _=g.querySelector(".dynamic-marker-label"),p=g.querySelector(".dynamic-marker-value");if(_||p){const t=-d;_&&(_.style.transform=`rotate(${t}deg)`,_.style.transition=`transform ${f}s ease-in-out`),p&&(p.style.transform=`rotate(${t}deg)`,p.style.transition=`transform ${f}s ease-in-out`)}s.currentAngle=d})}(this,t),this.config.debounce_updates?(this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this._updateGauge()},this.config.update_interval)):this._updateGauge())}disconnectedCallback(){this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null),this.animationInterval&&(clearInterval(this.animationInterval),this.animationInterval=null),this.pulsationInterval&&(clearInterval(this.pulsationInterval),this.pulsationInterval=null),this.pulsationInterval&&(clearInterval(this.pulsationInterval),this.pulsationInterval=null),this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null)}}console.info("%c CUSTOM-GAUGE-CARD \n%c Version 1.0.5 ","color: orange; font-weight: bold; background: black","color: white; font-weight: bold; background: dimgray"),customElements.define("custom-gauge-card",l)}();
